<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Getting Started with Siconos: Preliminaries</title>
<link href="WebSiconos.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<h1><a class="anchor" name="doc_prelim">Preliminaries</a></h1><h2><a class="anchor" name="cppPrelim">
Preliminaries on C++</a></h2>
Since the Siconos input file is written in C++, you need at least a basic knowledge of this language. See for example <a href="http://www.ibiblio.org/pub/docs/books/eckel/">Thinking in C++</a> from Bruce Eckel.<br>
 However, you can find in this first section the main C++ commands you need to know to write a first input file. <br>
<h3><a class="anchor" name="tutBuild">
Building/destroying and using objects</a></h3>
To describe your problem, you will mainly need to build an destroy pointers to objects. For example, suppose you want to build a <a class="elRef" doxygen="DoxygenKernel.tag:../../Doxygen/" href="../../Doxygen/d8/d7f/classLagrangianDS.html">LagrangianDS</a>, which belongs to the base class <a class="elRef" doxygen="DoxygenKernel.tag:../../Doxygen/" href="../../Doxygen/dc/da1/classDynamicalSystem.html">DynamicalSystem</a>, then do: <div class="fragment"><pre class="fragment"><a class="codeRef" doxygen="DoxygenKernel.tag:../../Doxygen/" href="../../Doxygen/dc/da1/classDynamicalSystem.html">DynamicalSystem</a> * nameOfMyDS = <span class="keyword">new</span> <a class="codeRef" doxygen="DoxygenKernel.tag:../../Doxygen/" href="../../Doxygen/d8/d7f/classLagrangianDS.html">LagrangianDS</a>(someParameters)
<span class="comment">// misc.</span>
<span class="comment">// ...</span>
delete nameOfMyDS
</pre></div> A call to <em>new</em> reserve memory and build the object, while <em>delete</em> release memory. <br>
 For each object, different types of constructors are available. See the corresponding Doxygen documentation of the class for an exhaustive list.<br>
 Access to methods of the objects is done thanks to "*" or "-&gt;": <div class="fragment"><pre class="fragment">nameOfMyDS-&gt;<a class="codeRef" doxygen="DoxygenKernel.tag:../../Doxygen/" href="../../Doxygen/dc/da1/classDynamicalSystem.html#5624576af211f9e9c00ae1aaf5384303">getType</a>(); <span class="comment">// return the type of the DynamicalSystem</span>
(*nameOfMyDS).getType(); <span class="comment">// Same thing. </span>
</pre></div> <h3><a class="anchor" name="tutHeader">
About include headers</a></h3>
For all objects you use in main.cpp, you need to include the corresponding header file.<br>
 Example: to use <a class="elRef" doxygen="DoxygenKernel.tag:../../Doxygen/" href="../../Doxygen/d8/d7f/classLagrangianDS.html">LagrangianDS</a> objects: <div class="fragment"><pre class="fragment"><span class="preprocessor">#include "<a class="codeRef" doxygen="DoxygenKernel.tag:../../Doxygen/" href="../../Doxygen/d9/d67/LagrangianDS_8h.html">LagrangianDS.h</a>"</span>
</pre></div> <h3><a class="anchor" name="tutTempl">
Siconos input file template</a></h3>
Any main.cpp should more or less looks like: <div class="fragment"><pre class="fragment"><span class="comment">// A list of include files </span>
<span class="preprocessor">#include "<a class="codeRef" doxygen="DoxygenKernel.tag:../../Doxygen/" href="../../Doxygen/d9/d67/LagrangianDS_8h.html">LagrangianDS.h</a>"</span>
<span class="comment">// ...</span>
<span class="comment">// The main </span>
<span class="keywordtype">int</span> <a class="code" href="tmp_8cpp.html#0ddf1224851353fc92bfbff6f499fa97">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])
{
  <span class="keywordflow">try</span>{

    <span class="comment">// Objects building</span>
    <a class="codeRef" doxygen="DoxygenKernel.tag:../../Doxygen/" href="../../Doxygen/d1/d2d/classNonSmoothDynamicalSystem.html">NonSmoothDynamicalSystem</a> * nsds = ...;
    <a class="codeRef" doxygen="DoxygenKernel.tag:../../Doxygen/" href="../../Doxygen/d6/d18/classModel.html">Model</a> * mod = <span class="keyword">new</span> <a class="codeRef" doxygen="DoxygenKernel.tag:../../Doxygen/" href="../../Doxygen/d6/d18/classModel.html">Model</a>(t0, t1);
 
    <span class="comment">// Release memory</span>
    <span class="keyword">delete</span> nsds;
    <span class="keyword">delete</span> mode;
     }
</pre></div><h2><a class="anchor" name="tutVector">
Vectors and Matrices handling</a></h2>
In Siconos, matrices and vectors handling is based on <a href="http://www.boost.org/libs/numeric/ublas/doc/index.htm">Boost Ublas library</a>. The Base (virtual) classes are <a class="elRef" doxygen="DoxygenKernel.tag:../../Doxygen/" href="../../Doxygen/d8/d76/classSiconosVector.html">SiconosVector</a> and <a class="elRef" doxygen="DoxygenKernel.tag:../../Doxygen/" href="../../Doxygen/d4/dee/classSiconosMatrix.html">SiconosMatrix</a>, with two kinds of usable derivated classes: Simple and Block. In addition some io classes are used for reading/writing object. <br>
<p>
<b>Main classes:</b> <em> <a class="elRef" doxygen="DoxygenKernel.tag:../../Doxygen/" href="../../Doxygen/d0/dd6/classSimpleVector.html">SimpleVector</a>, <a class="elRef" doxygen="DoxygenKernel.tag:../../Doxygen/" href="../../Doxygen/db/d5c/classSimpleMatrix.html">SimpleMatrix</a>, <a class="elRef" doxygen="DoxygenKernel.tag:../../Doxygen/" href="../../Doxygen/d6/ded/classBlockVector.html">BlockVector</a>, <a class="elRef" doxygen="DoxygenKernel.tag:../../Doxygen/" href="../../Doxygen/db/d20/classBlockMatrix.html">BlockMatrix</a>, <a class="elRef" doxygen="DoxygenKernel.tag:../../Doxygen/" href="../../Doxygen/d7/d8d/classioVector.html">ioVector</a>, <a class="elRef" doxygen="DoxygenKernel.tag:../../Doxygen/" href="../../Doxygen/d0/d4a/classioMatrix.html">ioMatrix</a></em><br>
<p>
Vectors can be dense or sparse and matrices dense, sparse, triangular, banded and symetric. <h3><a class="anchor" name="creatingVector">
Creating a vector:</a></h3>
<div class="fragment"><pre class="fragment"><span class="keywordtype">int</span> size = 4;
<span class="comment">// Dense vector</span>
<a class="codeRef" doxygen="DoxygenKernel.tag:../../Doxygen/" href="../../Doxygen/d8/d76/classSiconosVector.html">SiconosVector</a> * v = <span class="keyword">new</span> <a class="codeRef" doxygen="DoxygenKernel.tag:../../Doxygen/" href="../../Doxygen/d0/dd6/classSimpleVector.html">SimpleVector</a>(size); 
<span class="comment">// Or without pointers</span>
<a class="codeRef" doxygen="DoxygenKernel.tag:../../Doxygen/" href="../../Doxygen/d0/dd6/classSimpleVector.html">SimpleVector</a> w(size);
<span class="comment">// Sparse vector</span>
<a class="codeRef" doxygen="DoxygenKernel.tag:../../Doxygen/" href="../../Doxygen/d8/d76/classSiconosVector.html">SiconosVector</a> * z = <span class="keyword">new</span> <a class="codeRef" doxygen="DoxygenKernel.tag:../../Doxygen/" href="../../Doxygen/d0/dd6/classSimpleVector.html">SimpleVector</a>(size,SPARSE);
<span class="comment">// Read the vector from the file vect.dat (only for dense) </span>
<a class="codeRef" doxygen="DoxygenKernel.tag:../../Doxygen/" href="../../Doxygen/d8/d76/classSiconosVector.html">SiconosVector</a> * v2 = <span class="keyword">new</span> <a class="codeRef" doxygen="DoxygenKernel.tag:../../Doxygen/" href="../../Doxygen/d0/dd6/classSimpleVector.html">SimpleVector</a>(<span class="stringliteral">"vect.dat"</span>,1); <span class="comment">// 1: ascii, 0:binary</span>
</pre></div> <h3><a class="anchor" name="creatingMatrix">
Creating a matrix:</a></h3>
<div class="fragment"><pre class="fragment"><span class="keywordtype">int</span> row = 3, col = 3;
<span class="comment">// row X col Dense matrix:</span>
<a class="codeRef" doxygen="DoxygenKernel.tag:../../Doxygen/" href="../../Doxygen/d4/dee/classSiconosMatrix.html">SiconosMatrix</a> * m = <span class="keyword">new</span> <a class="codeRef" doxygen="DoxygenKernel.tag:../../Doxygen/" href="../../Doxygen/db/d5c/classSimpleMatrix.html">SimpleMatrix</a>(row,col);
<span class="comment">// Read from a file</span>
<a class="codeRef" doxygen="DoxygenKernel.tag:../../Doxygen/" href="../../Doxygen/d4/dee/classSiconosMatrix.html">SiconosMatrix</a> * m2 = <span class="keyword">new</span> <a class="codeRef" doxygen="DoxygenKernel.tag:../../Doxygen/" href="../../Doxygen/db/d5c/classSimpleMatrix.html">SimpleMatrix</a>(<span class="stringliteral">"mat.dat"</span>,1); <span class="comment">// 1: ascii, 0:binary</span>
</pre></div> <h3><a class="anchor" name="matIO">
Matrix/Vector Input/Output</a></h3>
<div class="fragment"><pre class="fragment"><span class="comment">// v is a vector, m a matrix</span>
<a class="codeRef" doxygen="DoxygenKernel.tag:../../Doxygen/" href="../../Doxygen/d7/d8d/classioVector.html">ioVector</a> myOutput (<span class="stringliteral">"MyData"</span>,<span class="stringliteral">"ascii"</span>); 
myOutput.read(v); <span class="comment">// read v from file MyData</span>
<a class="codeRef" doxygen="DoxygenKernel.tag:../../Doxygen/" href="../../Doxygen/d0/d4a/classioMatrix.html">ioMatrix</a> myMat(<span class="stringliteral">"outMat"</span>,<span class="stringliteral">"ascii"</span>);
myMat.write(m); <span class="comment">// Write m in file outMat</span>
</pre></div> Note that for reading, you can also directly use constructor as shown in <a class="el" href="doc_prelim.html#creatingVector">Creating a vector:</a>. <b> Input/Ouput Files format: </b> <br>
 On the first line, the dimensions, with space as separator. Then the data. Exemple, for a 2-rows, 3-columns matrix:<br>
 2 3<br>
 1 2 3<br>
 4 5 6<br>
 However, if you give as as second argument to <em>write</em> function "noDim", the first line with dimensions will skipped. <h3><a class="anchor" name="matUtils">
Useful functions</a></h3>
<div class="fragment"><pre class="fragment">v-&gt;<a class="codeRef" doxygen="DoxygenKernel.tag:../../Doxygen/" href="../../Doxygen/d8/d76/classSiconosVector.html#6c95c40e1dcdcd3f2b937aa5c1dba699">size</a>() <span class="comment">// return the size of the vector</span>
m-&gt;<a class="codeRef" doxygen="DoxygenKernel.tag:../../Doxygen/" href="../../Doxygen/d4/dee/classSiconosMatrix.html#b081eea358062842aaedd447aa0aee19">size</a>(0); <span class="comment">// number of rows in the matrix</span>
m-&gt;<a class="codeRef" doxygen="DoxygenKernel.tag:../../Doxygen/" href="../../Doxygen/d4/dee/classSiconosMatrix.html#b081eea358062842aaedd447aa0aee19">size</a>(1), <span class="comment">// number of columns</span>
v-&gt;<a class="codeRef" doxygen="DoxygenKernel.tag:../../Doxygen/" href="../../Doxygen/d8/d76/classSiconosVector.html#5a74ccf6343f1743406a92ff81c45ef7">zero</a>();  <span class="comment">// for matrix or vectors, set all elements to 0.</span>
m-&gt;<a class="codeRef" doxygen="DoxygenKernel.tag:../../Doxygen/" href="../../Doxygen/d4/dee/classSiconosMatrix.html#1a534199d0c0a0673e3ae9f46e52c929">eye</a>();   <span class="comment">// set m to identity</span>
m-&gt;<a class="codeRef" doxygen="DoxygenKernel.tag:../../Doxygen/" href="../../Doxygen/d4/dee/classSiconosMatrix.html#92140e2f9cca01f758287fc2a0a31589">resize</a>(a,b); <span class="comment">// resize m, available also for vectors</span>
m-&gt;<a class="codeRef" doxygen="DoxygenKernel.tag:../../Doxygen/" href="../../Doxygen/d4/dee/classSiconosMatrix.html#afed88dae12cc9da8998823055b01280">normInf</a>() ; <span class="comment">// compute infinite matrix norm of m</span>
<span class="comment">// Elements access: () </span>
(*v)(0) = 4;
w(1) = 2;
w(2) = (*v)(0);
</pre></div> All classical operators are also available, see doxygen. <br>
 For operations between matrices or vectors of different types, use prod, add or sub. <div class="fragment"><pre class="fragment"><span class="comment">// Let m1, m2, m3 be dense matrices and s a symetric matrix</span>
<span class="comment">// Then you can write:</span>
m3 = m1*m2; <span class="comment">// equivalent to m3 = prod(m1,m2);</span>
<span class="comment">// but you have to write</span>
m3 = prod(m1,s); 
</pre></div> In a general way, if you need efficiency, always prefer functions to overloaded operators.<h2><a class="anchor" name="tutGCtemplate">
Templates for main input file</a></h2>
<div class="fragment"><pre class="fragment"><span class="comment">// Header files</span>
<span class="preprocessor">#include "<a class="codeRef" doxygen="DoxygenKernel.tag:../../Doxygen/" href="../../Doxygen/d3/d5a/Model_8h.html">Model.h</a>"</span>
<span class="comment">// ...</span>
<span class="keyword">using namespace </span>std;

<span class="comment">// main program</span>
<span class="keywordtype">int</span> <a class="code" href="tmp_8cpp.html#0ddf1224851353fc92bfbff6f499fa97">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])
{
  <span class="comment">// Exception handling</span>
  <span class="keywordflow">try</span>{
    <span class="comment">// == User-defined parameters ==</span>
        
    <span class="comment">// ================= Creation of the model =======================</span>

    <span class="comment">// == Creation of the NonSmoothDynamicalSystem ==</span>
    <span class="comment">// -- DynamicalSystem(s) --</span>
    <span class="comment">// -- Interaction --</span>
    <span class="comment">// - Relations - </span>
    <span class="comment">// - NonSmoothLaw -</span>
    <span class="comment">// -- NonSmoothDynamicalSystem --   </span>
    <span class="comment">// -- Model --</span>
    <span class="comment">// == Creation of the Simulation ==</span>
    <span class="comment">// -- TimeDiscretisation --</span>
    <span class="comment">// -- OneStepIntegrator --</span>
    <span class="comment">// -- OneStepNSProblem --</span>
    <span class="comment">// ================================= Computation =================================</span>

    <span class="comment">// --- Initialisation of the simulation ---</span>

    <span class="comment">// --- Time loop ---</span>
    
    <span class="comment">// --- Free memory --- </span>
    <span class="keyword">delete</span> ...
   }
        
  <span class="keywordflow">catch</span>(<a class="codeRef" doxygen="DoxygenKernel.tag:../../Doxygen/" href="../../Doxygen/df/d73/classSiconosException.html">SiconosException</a> e)
    {cout &lt;&lt; e.<a class="codeRef" doxygen="DoxygenKernel.tag:../../Doxygen/" href="../../Doxygen/df/d73/classSiconosException.html#e16684853ac418122215d5d154303244">report</a>() &lt;&lt; endl;}
  <span class="keywordflow">catch</span>(...)
    {cout &lt;&lt; <span class="stringliteral">"Exception caught in \'mySample.cpp\'"</span> &lt;&lt; endl;}
}
</pre></div><h2><a class="anchor" name="prelSTLTool">
STL tools in Siconos</a></h2>
Something about sets (STL) <br>
 <hr size="1"><address style="align: right;"><small>Generated on Fri Nov 24 18:17:36 2006 for Getting Started with Siconos by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1 </small></address>
</body>
</html>
